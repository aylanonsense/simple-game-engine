<!DOCTYPE html>
<html>
	<head>
		<script>
			const FPS = 30

			// Create a JSON object to represent the game's state
			function init () {
				return {
					playerX: 2,
					playerY: 10
				}
			}

			// Advance the state forward one frame
			function update (state, keys) {
				// Move the player based on keyboard input
				if (keys.W) {
					state.playerY -= 1
				}
				if (keys.A) {
					state.playerX -= 1
				}
				if (keys.S) {
					state.playerY += 1
				}
				if (keys.D) {
					state.playerX += 1
				}
			}

			// Render the state however we'd like
			function draw (state, ctx) {
				// Clear the canvas
				ctx.fillStyle = '#000'
				ctx.fillRect(0, 0, canvas.width, canvas.height)
				// Draw the player
				ctx.fillStyle = '#f00'
				ctx.fillRect(state.playerX, state.playerY, 1, 1)
			}

			function main () {
				const canvas = document.getElementById('canvas')
				const ctx = canvas.getContext('2d')

				// Keep track of inputs
				const keys = {}
				document.addEventListener('keyup', evt => keys[evt.key.toUpperCase()] = false)
				document.addEventListener('keydown', evt => keys[evt.key.toUpperCase()] = true)

				// Create the starting state of the game
				let state = init()

				// Kick off the game loop
				setInterval(() => {
					// Update the game's state by one frame
					update(state, keys)

					// Draw the game's current state
					draw(state, ctx)
				}, Math.floor(1000 / FPS))
			}
		</script>
		<style>
			#canvas {
				width: 500px;
				height: 500px;
				image-rendering: pixelated;
			}
		</style>
	</head>
	<body onload="main()">
		<canvas id="canvas" width="30" height="30"></canvas>
	</body>
</html>
