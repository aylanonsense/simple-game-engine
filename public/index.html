<!DOCTYPE html>
<html>
	<head>
		<script>
			const FPS = 30

			// Create a JSON object to represent the game's state
			function init () {
				return {
					player: {
						x: 2,
						y: 10,
						width: 5,
						height: 5
					},
					coin: {
						x: 10,
						y: 20,
						width: 3,
						height: 3
					}
				}
			}

			// Advance the state forward one frame
			function update (state, keys) {
				// Move the player based on keyboard input
				if (keys.W) {
					state.player.y -= 1
				}
				if (keys.A) {
					state.player.x -= 1
				}
				if (keys.S) {
					state.player.y += 1
				}
				if (keys.D) {
					state.player.x += 1
				}
			}

			// Render the state however we'd like
			function draw (state, ctx) {
				// Clear the canvas
				ctx.fillStyle = '#000'
				ctx.fillRect(0, 0, canvas.width, canvas.height)
				// Draw the player
				ctx.fillStyle = '#f00'
				ctx.fillRect(state.player.x, state.player.y, state.player.width, state.player.height)
				// Draw the coin
				ctx.fillStyle = '#ff0'
				ctx.fillRect(state.coin.x, state.coin.y, state.coin.width, state.coin.height)
			}

			function main () {
				const canvas = document.getElementById('canvas')
				const ctx = canvas.getContext('2d')

				// Keep track of inputs
				const keys = {}
				document.addEventListener('keyup', evt => keys[evt.key.toUpperCase()] = false)
				document.addEventListener('keydown', evt => keys[evt.key.toUpperCase()] = true)

				// Create the starting state of the game
				let state = init()

				// Kick off the game loop
				setInterval(() => {
					// Update the game's state by one frame
					update(state, keys)

					// Draw the game's current state
					draw(state, ctx)
				}, Math.floor(1000 / FPS))
			}
		</script>
		<style>
			#canvas {
				width: 500px;
				height: 500px;
				image-rendering: pixelated;
			}
		</style>
	</head>
	<body onload="main()">
		<canvas id="canvas" width="30" height="30"></canvas>
	</body>
</html>
